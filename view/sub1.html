<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>패션스팟</title>
    <link rel="stylesheet" href="/static/css/sub1.css">
</head>
<body>
    <div class="recommendations">
        <h1>오늘의 추천 스팟</h1>
        <ul id="recommendedList"></ul>
    </div>
    <div id="mapModal" class="modal">
        <!-- 모달 내용 -->
        <div class="modal-content">
            <!-- 카카오 맵이 들어갈 컨테이너 -->
            <div id="kakaoMap" style="width: 100%; height: 400px;"></div>
            <!-- 모달 닫기 버튼 -->
            <span class="close" onclick="closeModal()">&times;</span>
        </div>
    </div>
    <div class="list-container">
        <h1>패션스팟 목록</h1>
        <ul id="myList"></ul>
    </div>
    <h1>더 많은 장소 준비중...</h1>

    <script src="https://t1.daumcdn.net/mapjsapi/js/main/4.4.14/kakao.js"></script>
    <script>
        const myList = document.getElementById('myList');
        const mapModal = document.getElementById('mapModal');
        const recommendedList = document.getElementById('recommendedList');

        fetch('./../json/items.json')
            .then(response => response.json())
            .then(data => {
                data.forEach(item => {
                    const li = document.createElement('li');
                    li.innerHTML = `
                        <img src="${item.imageUrl}" alt="${item.description}" />
                        <p>${item.description}</p>
                        <p>${item.additionalInfo}</p>
                    `;
                    li.classList.add('item');
                    li.setAttribute('data-lat', item.latitude);
                    li.setAttribute('data-lng', item.longitude);
                    myList.appendChild(li);
                });

                const items = document.querySelectorAll('#myList .item');
                items.forEach(item => {
                    item.addEventListener('click', function() {
                        openModal();
                        const lat = parseFloat(this.getAttribute('data-lat'));
                        const lng = parseFloat(this.getAttribute('data-lng'));
                        const container = document.getElementById('kakaoMap');
                        const options = {
                            center: new kakao.maps.LatLng(lat, lng),
                            level: 5
                        };
                        const map = new kakao.maps.Map(container, options);
                    });
                });

                // 랜덤 아이템 표시 함수 호출
                displayRandomItems(data);
            })
            .catch(error => console.error(error));

        // 모달 열기 함수
        function openModal() {
            mapModal.style.display = 'block';
        }

        // 모달 닫기 함수
        function closeModal() {
            mapModal.style.display = 'none';
        }

        // 랜덤 아이템 표시 함수
        function displayRandomItems(data) {
            const randomItems = getRandomItems(data, 3);
            randomItems.forEach(item => {
                const li = document.createElement('li');
                li.innerHTML = `
                    <img src="${item.imageUrl}" alt="${item.description}" />
                    <p>${item.description}</p>
                    <p>${item.additionalInfo}</p>
                `;
                recommendedList.appendChild(li);
            });
        }

        // 랜덤 아이템 반환 함수
        function getRandomItems(array, count) {
            const shuffled = array.sort(() => 0.5 - Math.random());
            return shuffled.slice(0, count);
        }
    </script>
</body>
</html>
