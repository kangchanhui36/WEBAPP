<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>패션스팟</title>
    <link rel="stylesheet" href="/static/css/sub1.css">
</head>

<body>

    <div class="recommendations">
        <h1>오늘의 추천 스팟</h1>
        <ul id="recommendedList"></ul>
    </div>

    <div class="list-container">
        <h1>패션스팟 목록</h1>
        <ul id="myList"></ul>
    </div>
    <h1>더 많은 장소 준비중...</h1>

    <script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=c28838cf2a769365bde72d7f8619c87e"></script>
    <script>
        const myList = document.getElementById('myList');
        const recommendedList = document.getElementById('recommendedList');

        fetch('items.json')
            .then(response => response.json())
            .then(data => {
                data.forEach(item => {
                    const li = document.createElement('li');
                    const img = document.createElement('img');
                    img.src = item.imageUrl;
                    img.alt = item.description;

                    const descriptionPara = document.createElement('p');
                    descriptionPara.textContent = item.description;
                    descriptionPara.classList.add('item-description');

                    const additionalInfo = document.createElement('p');
                    additionalInfo.textContent = item.additionalInfo;
                    additionalInfo.classList.add('additional-info');

                    li.appendChild(img);
                    li.appendChild(descriptionPara);
                    li.appendChild(additionalInfo);

                    // 이 부분은 클릭 시 해당 아이템에 대한 지도가 표시되는 부분입니다.
                    li.addEventListener('click', () => {
                        const mapContainer = document.createElement('div');
                        mapContainer.style.width = '100%';
                        mapContainer.style.height = '400px';

                        const map = new kakao.maps.Map(mapContainer, {
                            center: new kakao.maps.LatLng(item.latitude, item.longitude),
                            level: 4,
                        });

                        const markerPosition = new kakao.maps.LatLng(item.latitude, item.longitude);
                        const marker = new kakao.maps.Marker({
                            position: markerPosition,
                            map: map,
                        });

                        const content = `<div class="marker-text">${item.description}</div>`;
                        const overlay = new kakao.maps.CustomOverlay({
                            position: markerPosition,
                            content: content,
                            xAnchor: 0.5,
                            yAnchor: 2.5,
                        });

                        overlay.setMap(map);

                        const itemMapContainer = document.createElement('div');
                        itemMapContainer.appendChild(mapContainer);

                        li.appendChild(itemMapContainer);
                    });

                    // 기존의 아이템 목록에 추가하는 부분입니다.
                    myList.appendChild(li);
                });

                // 기존의 랜덤 추천 아이템을 표시하는 부분은 유지됩니다.
                function displayRandomItems() {
                    const randomItems = getRandomItems(data, 3);

                    randomItems.forEach(item => {
                        const li = document.createElement('li');
                        const img = document.createElement('img');
                        img.src = item.imageUrl;
                        const description = document.createElement('p');
                        description.textContent = item.description;
                        description.classList.add('item-description');
                        li.appendChild(img);
                        li.appendChild(description);
                        recommendedList.appendChild(li);
                    });
                }

                displayRandomItems();
            })
            .catch(error => console.error(error));

        function getRandomItems(array, count) {
            const shuffled = array.sort(() => 0.5 - Math.random());
            return shuffled.slice(0, count);
        }
    </script>
</body>

</html>
